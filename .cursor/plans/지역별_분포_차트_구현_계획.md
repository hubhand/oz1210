# 지역별 분포 차트 (Bar Chart) 구현 계획

## 목표

`components/stats/region-chart.tsx` 파일을 생성하여 지역별 관광지 분포를 Bar Chart로 시각화하는 컴포넌트를 구현합니다. 각 시/도별 관광지 개수를 막대 그래프로 표시하고, 인터랙션 기능을 제공합니다.

## 구현 내용

### 1. shadcn/ui Chart 컴포넌트 설치

- **명령어**: `pnpm dlx shadcn@latest add chart`
- **의존성**: recharts 자동 설치
- **설치 위치**: `components/ui/chart.tsx` 생성
- **확인 사항**: package.json에 recharts 추가 확인

### 2. 파일 생성 및 기본 구조

- **파일**: `components/stats/region-chart.tsx` 생성
- **구조**: Server Component로 구현 (기존 `stats-summary.tsx` 패턴 참고)
- **의존성**:
  - `lib/api/stats-api.ts`의 `getRegionStats()` 함수 사용
  - `lib/types/stats.ts`의 `RegionStats` 타입 사용
  - `components/ui/chart.tsx`의 Chart 컴포넌트 사용
  - `components/ui/error.tsx`의 `ErrorDisplay` 컴포넌트 사용
  - `components/ui/skeleton.tsx`의 `Skeleton` 컴포넌트 사용

### 3. Bar Chart 구현

- **차트 라이브러리**: recharts (shadcn/ui Chart 컴포넌트 기반)
- **차트 타입**: Bar Chart
- **X축**: 지역명 (서울, 부산, 제주 등)
- **Y축**: 관광지 개수
- **데이터 표시**: 상위 10개 지역 표시 (또는 전체 지역, 설정 가능)
- **차트 스타일**:
  - 카드 형태 (`rounded-lg border bg-card p-4 md:p-6`)
  - 다크/라이트 모드 지원 (Tailwind CSS 테마 활용)
  - 반응형 높이 (모바일: 300px, 데스크톱: 400px)

### 4. 인터랙션 기능

- **바 클릭**: 해당 지역의 관광지 목록 페이지로 이동
  - URL: `/?areaCode={regionCode}`
  - Next.js `Link` 또는 `router.push()` 사용
- **호버 효과**:
  - 바에 호버 시 정확한 개수 표시 (Tooltip)
  - 바 색상 변경 (highlight)
- **키보드 네비게이션**:
  - Tab 키로 각 바 포커스 이동
  - Enter/Space 키로 클릭 동작

### 5. 데이터 처리

- **데이터 소스**: `getRegionStats()` 함수 호출
- **데이터 필터링**: 상위 10개 지역만 표시 (선택 사항)
- **데이터 포맷팅**:
  - 숫자 포맷팅 (천 단위 구분 기호, `formatNumber()` 함수 재사용)
  - 지역명 표시 (긴 이름은 축약 처리)

### 6. 로딩 상태 (Skeleton UI)

- **컴포넌트**: `RegionChartSkeleton` 생성
- **디자인**:
  - 카드 형태의 스켈레톤
  - 차트 영역 스켈레톤 (막대 그래프 형태)
  - 제목 및 축 레이블 스켈레톤
- **사용 위치**: `app/stats/page.tsx`의 `Suspense` fallback

### 7. 에러 처리

- **에러 표시**: `ErrorDisplay` 컴포넌트 사용
- **에러 타입**: `TourApiError` 처리
- **재시도 기능**: 에러 발생 시 재시도 버튼 제공

### 8. 레이아웃 및 스타일링

- **카드 스타일**:
  - `rounded-lg border bg-card p-4 md:p-6`
  - 섹션 제목 (`text-xl md:text-2xl font-bold`)
- **차트 컨테이너**:
  - 반응형 너비 (전체 너비)
  - 최소 높이 설정 (모바일: 300px, 데스크톱: 400px)
- **간격**: 섹션 간 `space-y-8`

### 9. 접근성 지원

- **시맨틱 HTML**: `<section>`, `<h2>` 사용
- **ARIA 라벨**:
  - `aria-labelledby` (섹션 제목 연결)
  - `role="img"` (차트 영역)
  - `aria-label` (차트 설명)
- **스크린 리더**:
  - 차트 데이터를 테이블 형태로도 제공 (선택 사항)
  - 각 바에 `aria-label` 추가 (지역명, 개수)

### 10. 반응형 디자인

- **모바일**:
  - 차트 높이 300px
  - X축 레이블 회전 (45도 또는 90도)
  - 터치 이벤트 지원
- **태블릿**:
  - 차트 높이 350px
  - X축 레이블 가로 표시
- **데스크톱**:
  - 차트 높이 400px
  - 더 많은 정보 표시

### 11. 파일 헤더 주석 작성

- JSDoc 형식의 파일 헤더 주석 작성
- 다음 내용 포함:
  - 파일 설명
  - 주요 기능 설명
  - Props 인터페이스 설명 (없으면 생략)
  - 의존성 정보
  - 관련 문서 링크 (`@see` 태그)

### 12. 통계 페이지 통합

- **파일**: `app/stats/page.tsx` 업데이트
- **변경 사항**:
  - `RegionChart` 컴포넌트 import
  - `RegionChartSkeleton` 컴포넌트 import
  - `Suspense`로 감싸서 로딩 상태 처리
  - 기존 placeholder 섹션을 실제 컴포넌트로 교체
  - 파일 헤더 주석 업데이트 (Phase 4.4 완료 표시)

## 구현 세부사항

### 차트 데이터 구조

```typescript
// getRegionStats() 반환값
const regionStats: RegionStats[] = [
  { code: "1", name: "서울", count: 1234 },
  { code: "2", name: "인천", count: 567 },
  // ...
];

// 차트 데이터 변환
const chartData = regionStats
  .slice(0, 10) // 상위 10개만
  .map((stat) => ({
    name: stat.name,
    count: stat.count,
    code: stat.code,
  }));
```

### Bar Chart 컴포넌트 구조

```typescript
// recharts Bar Chart 예시
<BarChart data={chartData}>
  <CartesianGrid strokeDasharray="3 3" />
  <XAxis dataKey="name" />
  <YAxis />
  <Tooltip />
  <Bar dataKey="count" onClick={handleBarClick} />
</BarChart>
```

### 바 클릭 핸들러

```typescript
const handleBarClick = (data: any, index: number) => {
  const regionCode = chartData[index].code;
  router.push(`/?areaCode=${regionCode}`);
};
```

## 참고 파일

- `components/stats/stats-summary.tsx`: Server Component 패턴, 카드 스타일, 에러 처리
- `lib/api/stats-api.ts`: `getRegionStats()` 함수
- `lib/types/stats.ts`: `RegionStats` 타입 정의
- `docs/PRD.md`: 통계 대시보드 요구사항 (2.6.1 지역별 관광지 분포)
- `app/stats/page.tsx`: 통계 페이지 구조

## 아이콘 선택

- 지역별 분포: `BarChart3`, `MapPin`, `TrendingUp`

## 스타일 일관성

- 기존 컴포넌트와 동일한 카드 스타일 사용
- 패딩: `p-4 md:p-6`
- 제목 스타일: `text-xl md:text-2xl font-bold`
- 다크/라이트 모드 지원 (Tailwind CSS 테마)
